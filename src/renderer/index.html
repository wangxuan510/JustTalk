<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>Voice to Text - Status Indicator</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: transparent !important;
      overflow: hidden;
    }

    body {
      width: 40px;
      height: 40px;
      display: flex;
      justify-content: center;
      align-items: center;
      -webkit-app-region: no-drag;
    }

    .liquid-container {
      width: 40px;
      height: 40px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      background: transparent;
    }

    .liquid-blob {
      width: 20px;
      height: 20px;
      background: linear-gradient(135deg, #A855F7 0%, #7C3AED 100%);
      border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
      animation: blob-pulse 3s ease-in-out infinite;
      box-shadow: 0 3px 10px rgba(124, 58, 237, 0.4);
    }

    /* 监听状态 - 紫色 */
    .listening .liquid-blob {
      background: linear-gradient(135deg, #A855F7 0%, #7C3AED 100%);
      box-shadow: 0 5px 15px rgba(124, 58, 237, 0.4);
    }

    /* 处理状态 - 绿色 */
    .processing .liquid-blob {
      background: linear-gradient(135deg, #52c789 0%, #30d158 100%);
      box-shadow: 0 5px 15px rgba(52, 199, 137, 0.4);
      animation: blob-pulse 2s ease-in-out infinite;
    }

    /* 错误状态 - 红色 */
    .error .liquid-blob {
      background: linear-gradient(135deg, #ff6961 0%, #ff3b30 100%);
      box-shadow: 0 5px 15px rgba(255, 59, 48, 0.4);
      animation: shake 0.5s, blob-pulse 3s ease-in-out infinite;
    }

    @keyframes blob-pulse {
      0% {
        transform: scale(1);
        border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        box-shadow: 0 0 0 0 rgba(124, 58, 237, 0.7);
      }
      50% {
        transform: scale(1.15);
        border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%;
        box-shadow: 0 0 0 8px rgba(124, 58, 237, 0);
      }
      100% {
        transform: scale(1);
        border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        box-shadow: 0 0 0 0 rgba(124, 58, 237, 0.7);
      }
    }

    @keyframes shake {
      0%, 100% {
        transform: translateX(0);
      }
      25% {
        transform: translateX(-3px);
      }
      75% {
        transform: translateX(3px);
      }
    }
  </style>
</head>
<body>
  <div id="indicator" class="liquid-container listening">
    <div class="liquid-blob"></div>
  </div>
  <script>
    const indicator = document.getElementById('indicator');
    const blob = document.querySelector('.liquid-blob');

    // 使用安全的 API
    if (window.electronAPI) {
      // 监听状态更新
      window.electronAPI.onUpdateStatus((status) => {
        indicator.className = `liquid-container ${status}`;
      });

      // 监听音量更新 - 根据音量调整大小
      window.electronAPI.onUpdateVolume((volume) => {
        const scale = 1 + volume * 0.2; // 1.0 到 1.2
        blob.style.transform = `scale(${scale})`;
      });
    } else {
      console.error('electronAPI 未定义');
    }
  </script>
</body>
</html>
